<!DOCTYPE html><html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Футбольные матчи</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; padding: 20px; }
    h1 { text-align: center; }
    .controls { text-align: center; margin-bottom: 20px; }
    select, input, button { padding: 10px; margin: 5px; font-size: 16px; }
    .match { background: white; padding: 15px; margin: 10px auto; border-radius: 8px; max-width: 800px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .match h4 { margin: 0 0 5px; }
    .match a { color: #1e90ff; text-decoration: none; }
    .section-title { margin: 10px 0 5px; font-size: 16px; font-weight: bold; }
    ul { padding-left: 20px; }
  </style>
</head>
<body>
  <h1>Футбольные матчи</h1>  <div class="controls">
    <select id="leagueSelect">
      <option value="39">Premier League</option>
      <option value="140">La Liga</option>
      <option value="78">Bundesliga</option>
      <option value="135">Serie A</option>
      <option value="61">Ligue 1</option>
    </select>
    <input type="date" id="dateSelect" value="2025-08-06">
    <button onclick="applyFilters()">Показать</button>
  </div>  <div id="matches"></div>  <script>
    const apiKey = 'ВАШ_API_КЛЮЧ_СЮДА'; // ← Вставьте сюда свой ключ

    async function loadMatches(leagueId, date) {
      const url = `https://v3.football.api-sports.io/fixtures?league=${leagueId}&season=2024&date=${date}`;
      const res = await fetch(url, { headers: { 'x-apisports-key': apiKey } });
      const data = await res.json();
      await displayMatches(data.response);
    }

    async function displayMatches(matches) {
      const container = document.getElementById('matches');
      container.innerHTML = '';
      if (matches.length === 0) {
        container.innerHTML = '<p style="text-align:center;">Нет матчей на выбранную дату</p>';
        return;
      }

      for (const match of matches) {
        const { teams, fixture } = match;
        const fixtureId = fixture.id;

        // Параллельные запросы: прогнозы, статистика, составы
        const [predRes, statsRes, lineupRes] = await Promise.all([
          fetch(`https://v3.football.api-sports.io/predictions?fixture=${fixtureId}`, { headers: { 'x-apisports-key': apiKey } }),
          fetch(`https://v3.football.api-sports.io/fixtures/statistics?fixture=${fixtureId}`, { headers: { 'x-apisports-key': apiKey } }),
          fetch(`https://v3.football.api-sports.io/fixtures/lineups?fixture=${fixtureId}`, { headers: { 'x-apisports-key': apiKey } })
        ]);

        const predData = (await predRes.json()).response[0];
        const statsData = (await statsRes.json()).response;
        const lineupData = (await lineupRes.json()).response;

        // Получение данных по статистике
        const homeStats = statsData.find(s => s.team.id === teams.home.id)?.statistics || [];
        const awayStats = statsData.find(s => s.team.id === teams.away.id)?.statistics || [];
        const possessionHome = homeStats.find(s => s.type === 'Ball Possession')?.value || '-';
        const possessionAway = awayStats.find(s => s.type === 'Ball Possession')?.value || '-';
        const shotsHome = homeStats.find(s => s.type === 'Shots on Goal')?.value || '-';
        const shotsAway = awayStats.find(s => s.type === 'Shots on Goal')?.value || '-';

        // Получение составов
        const homeLineup = lineupData.find(l => l.team.id === teams.home.id)?.startXI || [];
        const awayLineup = lineupData.find(l => l.team.id === teams.away.id)?.startXI || [];

        // Построение HTML
        const div = document.createElement('div');
        div.className = 'match';
        div.innerHTML = `
          <h4>${teams.home.name} vs ${teams.away.name}</h4>
          <p>${new Date(fixture.date).toLocaleString()}</p>

          <div class="section-title">Прогноз:</div>
          <p>Победитель: ${predData.forecast || '—'}<br>
          Вероятности — Домашняя: ${predData.predictions.home_win_pct}%  Ничья: ${predData.predictions.draws_pct}%  Гостевая: ${predData.predictions.away_win_pct}%</p>

          <div class="section-title">Статистика матча:</div>
          <p>Владение мячом — ${possessioHome} vs ${possessionAway}<br>
             Удары в створ — ${shotsHome} vs ${shotsAway}</p>

          <div class="section-title">Составы:</div>
          <strong>${teams.home.name}</strong>
          <ul>${homeLineup.map(p => `<li>${p.player.name} (${p.position})</li>`).join('')}</ul>
          <strong>${teams.away.name}</strong>
          <ul>${awayLineup.map(p => `<li>${p.player.name} (${p.position})</li>`).join('')}</ul>

          <a href="https://www.youtube.com/results?search_query=${teams.home.name}+vs+${teams.away.name}+live" target="_blank">Смотреть трансляцию</a>
        `;
        container.appendChild(div);
      }
    }

    function applyFilters() {
      const leagueId = document.getElementById('leagueSelect').value;
      const date = document.getElementById('dateSelect').value;
      loadMatches(leagueId, date);
    }
  </script></body>
</html>
